# File Managed by Puppet

remote <%= @remote %>
port <%= @port %>
proto <%= @real_proto %>
dev <%= @dev %>

persist-key
persist-tun
keepalive 10 60
inactive 0


<% if @real_auth_type == "key" -%>
client
secret <%= scope.lookupvar("openvpn::config_dir") %>/<%= @name %>.key 
<% end -%>

<% if @real_auth_type == "tls" -%>
tls-client
ca <%= scope.lookupvar("openvpn::config_dir") %>/<%= "@#{server}-@#{instance}" %>/pki/ca.crt
cert <%= scope.lookupvar("openvpn::config_dir") %>/<%= @#{server}-@#{instance} %>/pki/<%= scope.lookupvar("::fqdn") %>.crt
key <%= scope.lookupvar("openvpn::config_dir") %>/<%= @#{server}-@#{instance} %>/pki/<%= scope.lookupvar("::fqdn") %>.key
tls-client
pull
<% end -%>

<% end -%>

ns-cert-type server
user <%= scope.lookupvar("openvpn::process_user") %>
group <%= scope.lookupvar("openvpn::process_user") %>

resolv-retry infinite
nobind

<% @route.each do |route_entry| -%>
route <%= route_entry %>
<% end -%>
